# NextJS

设置元数据，通过以下代码为每个页面设置标题及描述

```react
import type { Metadata } from "next";

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};
```



## 路由

### 访问方式

在 `src/app/page.tsx` 定义的路由通过 `/` 访问

在 `src/app/login/page.tsx` 定义的路由通过`/login` 访问



### 公共路由

在 `src/app/layout.tsx` 中可以接收参数 `childern`，这个children表示访问的那个路由，类似于 `Outlet`

```react
export default function RootLayout({ children }: Readonly<{ children: React.ReactNode }>) {
  return (
    <html lang="en">
      <body className={inter.className}>
        <h1>头部</h1>

        {/* 主体内容 */}
        <div className="page">
          {children}
        </div>
        
        <h1>底部</h1>
      </body>
    </html>
  );
}
```



### 路由跳转

**声明式跳转**

```js
import Link from "next/link";
```

```react
<Link href='/'>首页</Link>
<Link href='/login'>登陆页</Link>
```

注意 `next` 中需要导 `next/link`，且跳转路径为href。而在 `react` 中导 `react-router-dom` 且 通过 `to` 跳转，而不是 `href`



**编程式跳转**

```js
import { useRouter } from "next/navigation";
const router = useRouter()
```

```react
<button onClick={() => router.push("/")}>首页</button>
<button onClick={() => router.push("/login")}>登陆页</button>
```



### 动态路由

| 路由                          | 示例网址                                   | `params`                                                     |
| ----------------------------- | ------------------------------------------ | ------------------------------------------------------------ |
| `app/cate/[id]/page.js`       | `/cate/10`                                 | `{ id: '10' }`                                               |
| `app/cate/[...ids]/page.js`   | `/cate/10/20/30`                           | `{ ids: [ '10', '20', '30' ] }`                                |
| `app/cate/[[...ids]]/page.js` | `/cate`<br />`/cate/10`<br />`/cate/10/20` | `{}`<br />`{ ids: ['10'] }`<br />`{ ids: ['10', '20', '30'] }` |

如果你在双方括号内添加省略号，比如 `[[...ids]]`，这表示可选的捕获所有后面所有的路由片段。

也就是说，`app/cate/[[...ids]]/page.js` 会匹配 `/cate`，也会匹配 `/cate/100`、 `/cate/100/200`、`/cate/100/200/300` 等等。

它与上一种的区别就在于，不带参数的路由也会被匹配（就比如 `/shop`）



**示例：** `http://localhost:3000/cate/100?name=jack`

```react
const Cate = ({ params, searchParams }) => {
  console.log(params); // { id: '100' }
  console.log(searchParams); // { name: 'jack' }

  return (
    <>
      <h1>params：{params.id}</h1>
      <h1>searchParams：{searchParams.name}</h1>
    </>
  )
}

export default Cate
```

**注意：** 直接通过 `{ params, searchParams }` 解构的方式获取参数只支持页面使用



### 插槽路由

![image.png](https://img-blog.csdnimg.cn/img_convert/3627b758fea0f23fe9368ed1533188fe.png)

通过开头 `@` 形式的文件夹称之为插槽路由，就类似于Vue中的插槽，通过URL是访问不到它的

**格式：** `app/@team/page.tsx`

**使用：**

```react
export default function RootLayout({ team }: Readonly<{ team: React.ReactNode }>) {
  return (
    <html lang="en">
      <body>
        <h1>头部</h1>

        {/* 主体内容 */}
        <div className="page">
          {/* 使用插槽路由 */}
          {team}
        </div>

        <h1>底部</h1>
      </body>
    </html>
  );
}
```

平行路由的使用方式就是将文件夹以 `@` 作为开头进行命名，这个文件夹下面的 `page.js` 将会自动注入文件夹同级 `layout` 的 `props` 中。

**注：** 从这张图还可以看出，`children prop` 其实就是一个隐式的插槽，`/app/page.js` 相当于 `app/@children/page.js`



### 路由分组

默认情况下在 `app` 目录中会将文件映射为 `Url` 路径，如果我们不想让当前的目录被映射，可以这么做

将文件夹名称扩在括号当中，例如（ `api_grop` ）这样当前这个目录就不会被映射了，而是映射里面没有被分组的目录



### 私人文件夹

如果我们想让 `app` 目录中某个目录的所有文件不被映射，那么可以通过私人文件夹来实现

可以将文件夹名称前面加上 `_` 即可定义为私人文件夹，例如（ `_api` ）



## 疑点

**目录中 pages 与 app 两种目录结构的区别是什么？**

1. `pages` 中任意人家都会被定义为路由，而 `app` 只会定义名称为 `page` 和 `route` 的文件


# 踩过的坑

`Image` 在通过 `output: 'export'` 静态打包时候图片加载不出来，需要更改为 `img` 标签